<!DOCTYPE html>
<html lang="en">

<head>
    <script type="application/javascript">
        function connect() {
            const errorText = document.getElementById('error');
            const ipInput = document.getElementById('ip');
            const connectButton = document.getElementById('connect');
            errorText.innerText = '';
            ipInput.disabled = true;
            connectButton.disabled = true;
            connectButton.innerText = 'Connecting...';
            setTimeout(() => {
                Homey.emit('connect', ipInput.value).then(function (error) {
                    errorText.innerText = error;
                    ipInput.disabled = false;
                    connectButton.disabled = false;
                    connectButton.innerText = 'Connect';
                });
            }, 1000);
        }
    </script>

    <style>
        h1 {
            margin-top: 1em;
        }

        #ip {
            width: 100%;
        }

        #connect {
            width: 100%;
            color: black;
        }

        #connect:disabled {
            color: grey;
        }
        
        #error {
            color: red;
        }
    </style>
</head>

<body>
    <h1>Fixed IP address of the NGBS iCON controller</h1>
    <p>
        It's important that this address doesn't change, otherwise the integration will break.
        Either configure your router to always assign the same IP to this device over DHCP, or
        configure the controller to use a fixed IP instead of using DHCP.
    </p>
    <p>
        <input id="ip" required type="text" minlength="7" maxlength="15" placeholder="e.g. 192.168.1.15"
            onkeyup="document.getElementById('connect').disabled = !validity.valid">
    </p>
    <p><button id="connect" disabled onclick="connect()">Connect</button></p>
    <p id="error"></p>
</body>

</html>